# Kind2Anki Field Mapping for 9-Field Note Type

## Updated Field Mapping

The addon now maps Kindle vocabulary data to your 9-field note type as follows:

### Field Structure
| # | Field Name | Content Source | Description |
|---|------------|----------------|-------------|
| 1 | **Word** | Kindle vocabulary word | The target vocabulary word |
| 2 | **Word Type** | Auto-detected | Basic part of speech (noun, verb, adjective, etc.) |
| 3 | **Phonetic** | Kindle reading data | Pronunciation/phonetic reading if available |
| 4 | **Example** | Kindle usage sentence | Context sentence with word replaced by `_____` |
| 5 | **Sound** | Generated audio reference | `[sound:word.mp3]` format for Anki audio |
| 6 | **Image** | Empty | Intentionally left empty as requested |
| 7 | **Def** | Dictionary + Translation | Combined definition from multiple sources |
| 8 | **Content** | Book metadata | Source book information |
| 9 | **Copyright** | Attribution | "Generated by Kind2Anki from Kindle Vocabulary Builder" |

## Example Output

For a word like "magnificent" from "Pride and Prejudice":

```
Field 1 (Word): magnificent
Field 2 (Word Type): adjective
Field 3 (Phonetic): /mæɡˈnɪfɪsənt/
Field 4 (Example): The ballroom was _____ with crystal chandeliers.
Field 5 (Sound): [sound:magnificent.mp3]
Field 6 (Image): [empty]
Field 7 (Def): extremely beautiful, elaborate, or impressive<hr>Dictionary: having grandeur or splendor
Field 8 (Content): Source: Pride and Prejudice
Field 9 (Copyright): Generated by Kind2Anki from Kindle Vocabulary Builder
```

## Key Features

### 1. Fill-in-the-Blank Examples
- Original sentence: "The ballroom was magnificent with crystal chandeliers."
- Processed: "The ballroom was _____ with crystal chandeliers."
- **Smart replacement**: Handles punctuation and word variations
- **Case-insensitive**: Finds words regardless of capitalization
- **Preserves context**: Maintains original sentence structure

### 2. Word Type Detection
Basic heuristic-based detection:
- **Verbs**: Words ending in -ing, -ed, -en
- **Adverbs**: Words ending in -ly
- **Adjectives**: Words ending in -ful, -less, -ous, -ive, -able, -ible
- **Nouns**: Words ending in -tion, -sion, -ness, -ment, -ity, -ty
- **Phrases**: Multi-word expressions
- **Default**: "word" for others

### 3. Combined Definitions
- **Translation**: If translation is enabled
- **Dictionary**: If dictionary lookup is enabled
- **Separator**: `<hr>` tag to visually separate sources
- **Fallback**: Uses Kindle's original definition if others fail

### 4. Audio Integration
- Format: `[sound:word.mp3]` (Anki standard)
- Ready for audio file addition
- Supports Anki's built-in audio playback

### 5. Image Field Handling
- Intentionally left empty as requested
- Can be manually populated later if needed
- Maintains field structure compatibility

## Import Settings Impact

Different checkbox settings affect field population:

### Include Usage Sentences ✓
- **Enabled**: Field 4 gets fill-in-the-blank sentence
- **Disabled**: Field 4 remains empty

### Translate Words ✓
- **Enabled**: Adds translation to Field 7 (Def)
- **Disabled**: Only uses dictionary definition

### Include Dictionary Definitions ✓
- **Enabled**: Adds dictionary definition to Field 7 (Def)
- **Disabled**: Only uses translation (if enabled)

## Technical Implementation

### Word Replacement Algorithm
```python
# Smart word replacement preserving punctuation
words_in_sentence = sentence.split()
for i, sentence_word in enumerate(words_in_sentence):
    clean_word = sentence_word.strip('.,!?;:"()[]').lower()
    if clean_word == word_lower or clean_word.startswith(word_lower):
        punctuation = ''.join(c for c in sentence_word if not c.isalnum())
        words_in_sentence[i] = "_____" + punctuation
        break
```

### Field Assembly
```python
fields = [
    card_data["word"],                          # 1: Word
    word_type,                                  # 2: Word Type
    card_data["reading"],                       # 3: Phonetic
    card_data["sentence"],                      # 4: Example (with _____)
    f"[sound:{card_data['word']}.mp3]",        # 5: Sound
    "",                                         # 6: Image (empty)
    definition,                                 # 7: Def
    f"Source: {card_data['book_name']}",       # 8: Content
    "Generated by Kind2Anki from Kindle Vocabulary Builder" # 9: Copyright
]
```

## Benefits of This Mapping

1. **Active Learning**: Fill-in-the-blank promotes active recall
2. **Context Preservation**: Original usage context maintained
3. **Multi-source Definitions**: Comprehensive meaning coverage
4. **Metadata Tracking**: Source book and generation info preserved
5. **Audio Ready**: Prepared for pronunciation practice
6. **Flexible Structure**: Empty image field for future use

## Installation and Usage

1. Install the updated `kind2anki.ankiaddon` package
2. Ensure your note type has exactly 9 fields in the specified order
3. Run the import with desired settings
4. Review generated cards and add audio files if needed

The mapping ensures maximum compatibility with your existing note structure while providing rich, educational content for effective vocabulary learning.
